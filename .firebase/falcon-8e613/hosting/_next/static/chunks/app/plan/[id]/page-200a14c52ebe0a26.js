(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{9449:function(e,t,n){Promise.resolve().then(n.bind(n,4670)),Promise.resolve().then(n.bind(n,8333)),Promise.resolve().then(n.bind(n,7965)),Promise.resolve().then(n.bind(n,402)),Promise.resolve().then(n.bind(n,9973))},4670:function(e,t,n){"use strict";n.d(t,{CreateEvent:function(){return y}});var r=n(7437),s=n(4662),a=n(9733),i=n(7209),l=n(2265),o=n(2157),c=n(9772),d=n(4157),m=n(624),h=n(9343),u=n(1014),x=n(3363),v=n(771),j=n(8068),f=n(6460),g=n(4241),p=n(9354),_=n(9081),N=n(1413);function b(e){let{className:t,field:n}=e,[s,i]=l.useState();return(0,r.jsx)("div",{className:(0,p.cn)("grid gap-2",t),children:(0,r.jsxs)(N.J2,{children:[(0,r.jsx)(N.xo,{asChild:!0,children:(0,r.jsxs)(a.z,{variant:"outline",className:(0,p.cn)("justify-start text-left font-normal",!n.value&&"text-muted-foreground"),children:[(0,r.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),n.value?(0,f.WU)(n.value,"PPP"):(0,r.jsx)("span",{children:"Pick a date"})]})}),(0,r.jsx)(N.yk,{className:"w-auto p-0",children:(0,r.jsx)(_.f,{mode:"single",selected:n.value,onSelect:n.onChange,initialFocus:!0})})]})})}let y=e=>{let t=(0,o.e)(),[n,f]=(0,l.useState)(!1),g=(0,m.D)(e.start_date),p=(0,m.D)(e.end_date),_=c.z.object({event_name:c.z.string().min(1,{message:"Name cannot be empty"}),event_location:c.z.string().min(1,{message:"Location cannot be empty"}),event_date:c.z.date().refine(e=>e>=g&&e<=p,{message:"Event must be within itinerary dates"}),event_notes:c.z.string().optional()}),N=(0,h.cI)({resolver:(0,u.F)(_),defaultValues:{event_date:g,event_notes:""}}),[y,w]=(0,l.useState)({}),S=async e=>{(0,d.z)({onError:w,data:e,onSuccess:e=>{z(e)},schema:_})};async function z(n){var r;let s=await t.auth.getUser(),{data:a,error:i}=await t.rpc("CreateEvent",{event_created_by_uuid:null===(r=s.data.user)||void 0===r?void 0:r.id,event_date:n.event_date.toISOString(),event_itinerary_id:e.itinerary_id,event_location:n.event_location,event_name:n.event_name,event_notes:n.event_notes});if(i){console.log(i),(0,j.Am)({title:"Error Creating Event",description:"Something went wrong, please try again later."});return}f(!1)}return(0,r.jsxs)(s.Vq,{open:n,onOpenChange:f,children:[(0,r.jsx)(s.hg,{asChild:!0,children:(0,r.jsx)(a.z,{className:"h-10 rounded-md bg-slate-900 hover:bg-slate-800 hover:text-slate-100 text-slate-50 px-5",children:"Add item"})}),(0,r.jsxs)(s.cZ,{className:"sm:max-w-[425px]",children:[(0,r.jsx)(s.fK,{children:(0,r.jsx)(s.$N,{children:"New Event"})}),(0,r.jsx)("div",{className:"grid gap-4 py-4",children:(0,r.jsx)(x.l0,{...N,children:(0,r.jsxs)("form",{className:"space-y-8",onSubmit:N.handleSubmit(S),children:[(0,r.jsx)("div",{className:"grid grid-cols-1 items-center gap-4",children:(0,r.jsx)(x.Wi,{control:N.control,name:"event_name",render:e=>{let{field:t}=e;return(0,r.jsxs)(x.xJ,{children:[(0,r.jsx)(x.lX,{children:"Name"}),(0,r.jsx)(i.I,{...t,name:"event_name",placeholder:"What are you doing?",type:"text",id:"event_name"}),(0,r.jsx)(x.zG,{})]})}})},"event_name"),(0,r.jsx)("div",{className:"grid grid-cols-1 items-center gap-4",children:(0,r.jsx)(x.Wi,{control:N.control,name:"event_location",render:e=>{let{field:t}=e;return(0,r.jsxs)(x.xJ,{children:[(0,r.jsx)(x.lX,{children:"Location"}),(0,r.jsx)(i.I,{...t,name:"event_location",placeholder:"Where are you going?",type:"text",id:"event_location"}),(0,r.jsx)(x.zG,{})]})}})},"event_location"),(0,r.jsx)("div",{className:"grid grid-cols-1 items-center gap-4",children:(0,r.jsx)(x.Wi,{control:N.control,name:"event_date",render:e=>{let{field:t}=e;return(0,r.jsxs)(x.xJ,{children:[(0,r.jsx)(x.lX,{children:"Dates"}),(0,r.jsx)(b,{field:t}),(0,r.jsx)(x.zG,{})]})}})},"event_date"),(0,r.jsx)("div",{className:"grid grid-cols-1 items-center gap-4",children:(0,r.jsx)(x.Wi,{control:N.control,name:"event_notes",render:e=>{let{field:t}=e;return(0,r.jsxs)(x.xJ,{children:[(0,r.jsx)(x.lX,{children:"Notes"}),(0,r.jsx)(i.I,{...t,name:"event_notes",placeholder:"Additional Info...",type:"text",id:"event_notes"}),(0,r.jsx)(x.zG,{})]})}})},"event_notes"),(0,r.jsx)("div",{className:"grid-rows-1 items-center gap-4",children:(0,r.jsx)(a.z,{className:"float-right",children:"Create"})})]})})})]}),(0,r.jsx)(v.x,{})]})}},8333:function(e,t,n){"use strict";n.d(t,{default:function(){return m}});var r=n(7437),s=n(2265),a=n(2157),i=n(402),l=n(8185),o=n(624);function c(e){let t=(0,o.D)(e.date).toLocaleTimeString([],{hour:"numeric",minute:"numeric",hour12:!0});return(0,r.jsxs)(l.Zb,{className:"shadow-sm hover:shadow-md mt-10 mr-10",children:[(0,r.jsxs)(l.Ol,{children:[(0,r.jsx)(l.ll,{children:e.name}),(0,r.jsxs)(l.SZ,{children:[e.location," @ ",t]})]}),(0,r.jsx)(l.aY,{}),(0,r.jsx)(l.eW,{children:(0,r.jsx)("div",{className:"grid-rows-1 items-center gap-4 text-sm",children:(0,r.jsx)("p",{children:e.notes})})})]})}function d(e){let{events:t}=e,n=Array.from(t.entries()).sort((e,t)=>e[0]>t[0]?1:-1);return(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 max-w-6xl w-full",children:n.map(e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"mt-10",children:[(0,r.jsx)(i.Label,{className:"text-2xl font-semibold",children:t}),Array.from(n.entries()).map(e=>{let[t,n]=e;return(0,r.jsx)(c,{id:n.id,name:n.name,location:n.location,date:n.date,notes:n.notes,created_by:n.created_by},n.id)})]},t)})})}function m(e){let{initialEvents:t,itinerary_id:n}=e,[i,l]=(0,s.useState)(new Map(t)),c=(0,a.e)(),m=e=>e.toLocaleString("default",{month:"long"})+" "+e.getDate();return(0,s.useEffect)(()=>{let e=c.channel("table-db-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"events",filter:"itinerary_id=eq.".concat(n)},e=>{l(t=>{let n=new Map(t),r=e.new,s=m((0,o.D)(r.date)),a=new Map,i=n.get(s);return i||(i=a),i.set(r.id,r),n.set(s,i),n})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"events",filter:"itinerary_id=eq.".concat(n)},e=>{l(t=>{let n=new Map(t),r=e.old,s=m((0,o.D)(r.date)),a=n.get(s);return a.delete(r.id),n.set(s,a),n})}).subscribe();return()=>{c.removeChannel(e)}},[c,n]),(0,r.jsx)(d,{events:i})}},7965:function(e,t,n){"use strict";n.d(t,{ItineraryUsersList:function(){return m}});var r=n(7437),s=n(2265),a=n(2286),i=n(9354);let l=s.forwardRef((e,t)=>{let{className:n,children:s,...l}=e;return(0,r.jsxs)(a.fC,{ref:t,className:(0,i.cn)("relative overflow-hidden",n),...l,children:[(0,r.jsx)(a.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(o,{}),(0,r.jsx)(a.Ns,{})]})});l.displayName=a.fC.displayName;let o=s.forwardRef((e,t)=>{let{className:n,orientation:s="vertical",...l}=e;return(0,r.jsx)(a.gb,{ref:t,orientation:s,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",n),...l,children:(0,r.jsx)(a.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=a.gb.displayName;var c=n(9973),d=n(2157);function m(e){let{itinerary_id:t}=e,n=(0,d.e)(),[a,i]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(async()=>{if(t){let{data:e,error:r}=await n.rpc("GetUsersByItineraryId",{query_id:t});r?console.error(r):i(e)}})().catch(console.error)},[t,n]),(0,r.jsx)(l,{className:"h-72 w-70 rounded-md border",children:(0,r.jsx)("div",{className:"p-4",children:a.map(e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-sm",children:(0,r.jsx)("p",{children:e.email})},e.email),(0,r.jsx)(c.Separator,{className:"my-2"})]}))})})}},9973:function(e,t,n){"use strict";n.d(t,{Separator:function(){return l}});var r=n(7437),s=n(2265),a=n(8484),i=n(9354);let l=s.forwardRef((e,t)=>{let{className:n,orientation:s="horizontal",decorative:l=!0,...o}=e;return(0,r.jsx)(a.f,{ref:t,decorative:l,orientation:s,className:(0,i.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",n),...o})});l.displayName=a.f.displayName}},function(e){e.O(0,[203,52,854,194,1,971,23,744],function(){return e(e.s=9449)}),_N_E=e.O()}]);